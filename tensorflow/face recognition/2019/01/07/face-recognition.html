<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Face Recognition | Overfitted</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Face Recognition" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Learn to create Face Recognition system from scratch" />
<meta property="og:description" content="Learn to create Face Recognition system from scratch" />
<link rel="canonical" href="https://aniketmaurya.github.io/blog/tensorflow/face%20recognition/2019/01/07/face-recognition.html" />
<meta property="og:url" content="https://aniketmaurya.github.io/blog/tensorflow/face%20recognition/2019/01/07/face-recognition.html" />
<meta property="og:site_name" content="Overfitted" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-07T00:00:00-06:00" />
<script type="application/ld+json">
{"headline":"Face Recognition","description":"Learn to create Face Recognition system from scratch","datePublished":"2019-01-07T00:00:00-06:00","dateModified":"2019-01-07T00:00:00-06:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://aniketmaurya.github.io/blog/tensorflow/face%20recognition/2019/01/07/face-recognition.html"},"url":"https://aniketmaurya.github.io/blog/tensorflow/face%20recognition/2019/01/07/face-recognition.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://aniketmaurya.github.io/blog/feed.xml" title="Overfitted" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-156199072-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Face Recognition | Overfitted</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Face Recognition" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Learn to create Face Recognition system from scratch" />
<meta property="og:description" content="Learn to create Face Recognition system from scratch" />
<link rel="canonical" href="https://aniketmaurya.github.io/blog/tensorflow/face%20recognition/2019/01/07/face-recognition.html" />
<meta property="og:url" content="https://aniketmaurya.github.io/blog/tensorflow/face%20recognition/2019/01/07/face-recognition.html" />
<meta property="og:site_name" content="Overfitted" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-01-07T00:00:00-06:00" />
<script type="application/ld+json">
{"headline":"Face Recognition","description":"Learn to create Face Recognition system from scratch","datePublished":"2019-01-07T00:00:00-06:00","dateModified":"2019-01-07T00:00:00-06:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://aniketmaurya.github.io/blog/tensorflow/face%20recognition/2019/01/07/face-recognition.html"},"url":"https://aniketmaurya.github.io/blog/tensorflow/face%20recognition/2019/01/07/face-recognition.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://aniketmaurya.github.io/blog/feed.xml" title="Overfitted" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-156199072-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Overfitted</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Face Recognition</h1><p class="page-description">Learn to create Face Recognition system from scratch</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2019-01-07T00:00:00-06:00" itemprop="datePublished">
        Jan 7, 2019
      </time>
       ‚Ä¢ <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#Tensorflow">Tensorflow</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#Face Recognition">Face Recognition</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#face-verification-vs-face-recognition">Face Verification vs. Face Recognition</a>
<ul>
<li class="toc-entry toc-h3"><a href="#why-pixel-by-pixel-comparison-of-images-isabadidea">Why pixel-by-pixel comparison of images is¬†a¬†bad¬†idea?</a></li>
<li class="toc-entry toc-h3"><a href="#face-embedding-come-to-the-rescue">Face Embedding come to the rescue</a></li>
<li class="toc-entry toc-h3"><a href="#how-to-finetune-these-embeddings">How to finetune these embeddings?</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#by-now-you-know-the-underlying-concepts-of-face-recognition-i-will-tell-you-how-to-create-a-face-verification-and-recognition-system-its-super-easy">By now you know the underlying concepts of Face Recognition, I will tell you how to create a Face Verification and Recognition system. It‚Äôs super easy.</a></li>
<li class="toc-entry toc-h2"><a href="#if-you-have-learned-something-then-feel-free-to-press-for-as-long-as-you-want">If you have learned something then feel free to pressüëè for as long as you wantüòÉ.</a></li>
<li class="toc-entry toc-h2"><a href="#if-you-find-anything-wrong-please-mention-it-in-the-comments-i-would-Ô∏è-to-improve">If you find anything wrong, please mention it in the comments. I would ‚ù§Ô∏è to improve.</a></li>
</ul><p>AI is revolutionizing the world. Face recognition is one such spectrum of it. Almost everyone uses face recognition systems ‚Äî on our mobile, Facebook, Photo gallery apps or advanced security cameras. Learn how these systems are able to recognize our faces. This article is inspired by the deeplearning.ai course on FaceNet.</p>

<p><img src="https://cdn-images-1.medium.com/max/2000/1*t3DEmVOWOuWjIo_TjcpxNQ.gif" alt=""></p>

<h2 id="face-verification-vs-face-recognition">
<a class="anchor" href="#face-verification-vs-face-recognition" aria-hidden="true"><span class="octicon octicon-link"></span></a>Face Verification vs. Face Recognition</h2>

<p><em>Face Verification</em>** **checks ‚Äúis this the claimed person?‚Äù. For example, in school, you go with your ID card and the invigilator verifies your face with the ID card. This is Face Verification. A mobile phone that unlocks using our face is also using face verification. It is 1:1 matching problem.</p>

<p>Now suppose the invigilator knows everyone by their name. So, you decide to go there without an ID card. The invigilator identifies your face and lets you in. This is Face Recognition. <em>Face Recognition</em>** **deals with ‚Äúwho is this person?‚Äù problem. We can say that it is a 1:K problem.</p>

<h3 id="why-pixel-by-pixel-comparison-of-images-isabadidea">
<a class="anchor" href="#why-pixel-by-pixel-comparison-of-images-isabadidea" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why pixel-by-pixel comparison of images is¬†a¬†bad¬†idea?</h3>

<p>A simple way for face verification can be comparing two images pixel-by-pixel and if the threshold between images is less than a threshold then we can say that they‚Äôre the same person. But since the pixel values in an image change dramatically even with a slight change of light, position or orientation. So, this method doesn‚Äôt work well.</p>

<h3 id="face-embedding-come-to-the-rescue">
<a class="anchor" href="#face-embedding-come-to-the-rescue" aria-hidden="true"><span class="octicon octicon-link"></span></a>Face Embedding come to the rescue</h3>

<p>The <em>embedding</em> is represented by f (x), a d-dimensional vector. It encodes an image ‚Äòx‚Äô into a d-dimensional Euclidean space. The face embedding of two images of the same person are similar to each other and that of different persons are very different.</p>

<p>In ConvNet architectures, the initial layers learn to recognize basic patterns like straight lines, edges, circles, etc. and the deeper layers learn to recognize more complex patterns like numbers, faces, cars, etc.</p>

<p>To get our embedding we feed the image into a pre-trained model then run a forward propagation and extract the vector from some deeper Fully-Connected layer. You can learn the basics of CNN <a href="https://medium.com/@aniketmaurya/not-just-introduction-to-convolutional-neural-networks-part-2-a7ac2723e30d">here</a>.</p>

<h3 id="how-to-finetune-these-embeddings">
<a class="anchor" href="#how-to-finetune-these-embeddings" aria-hidden="true"><span class="octicon octicon-link"></span></a>How to finetune these embeddings?</h3>

<p>[<em>The Triplet Loss](https://en.wikipedia.org/wiki/Triplet_loss)</em> function takes the responsibility to <em>push</em> the embeddings of two images of the same person (Anchor and Positive) closer together while <em>pulling</em> the embeddings of two images of different persons (Anchor, Negative) further apart.</p>

<p><img src="https://cdn-images-1.medium.com/max/3840/1*CKnxCH4SNOnTqctwX-ViKQ.png" alt="Source: [Coursera](http://deeplearning.ai)"><em>Source: <a href="http://deeplearning.ai">Coursera</a></em></p>

<p><strong>‚à•f(X1) ‚Äî f(X2)‚à•¬≤ **is the degree of similarity between image X1 and X2. If it‚Äôs smaller than a chosen threshold then both are the same person. If you‚Äôre wondering ‚Äúwhat this **‚à•</strong>A<em>*‚à• **weird symbol is?‚Äù, it‚Äôs called *Frobenius Norm</em> and you don‚Äôt need to worry about it.</p>

<p>The distance between <em>Anchor</em> and <em>Positive</em> images should be less and the distance between <em>Anchor</em> and <em>Negative</em> images should be high.</p>

<p>i.e. <strong>‚à•f(Anchor) ‚Äî f(Positive)‚à•¬≤ ‚â§ ‚à•f(Anchor) ‚Äî f(Negative)‚à•¬≤</strong>.</p>

<h2 id="by-now-you-know-the-underlying-concepts-of-face-recognition-i-will-tell-you-how-to-create-a-face-verification-and-recognition-system-its-super-easy">
<a class="anchor" href="#by-now-you-know-the-underlying-concepts-of-face-recognition-i-will-tell-you-how-to-create-a-face-verification-and-recognition-system-its-super-easy" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>By now you know the underlying concepts of Face Recognition, I will tell you how to create a Face Verification and Recognition system. It‚Äôs super easy.</strong>
</h2>

<p>Training a Face recognition model is computationally expensive so I‚Äôll recommend downloading a <a href="https://github.com/iwantooxxoox/Keras-OpenFace">pre-trained model</a>. Start with creating a database of persons containing an embedding vector for each.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>*#create a dictionary database
*db = dict()
*#encoding(image_path) converts image to embedding
*db['person1'] = encoding('person1.jpg')
db['person2'] = encoding('person2.jpg')
db['person3'] = encoding('person3.jpg')
db['person4'] = encoding('person4.jpg')
db['person5'] = encoding('person5.jpg')
</code></pre></div></div>

<p>Now that we have created our database, we can define a function that accepts image embedding and name of the person as the argument and it will verify if they are the same person.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>**def** verify(embedding, person_name):
     
*    # numpy.linalg.norm calculates the Frobenius Norm
*    dist = np.linalg.norm(embedding - db[person_name])
    
*    # Chosen threshold is 0.7  
*    **if** dist &lt; 0.7:
        print("Verified! Welcome " + person_name)
    **else**:
        print("Person name and face didn't match!")
</code></pre></div></div>

<p>Hurray üòé! We created our Face Verification system. Now let‚Äôs create the Face Recognition System. If you remember, a person doesn‚Äôt need any ID in the face recognition system. He just needs to show his face to the camera.</p>

<p>In Face recognition, the distance will be calculated for all the images in the database against the input embedding and the smallest distance has to be searched.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>**def** recognize_me(input_embedding):

*    # Set min_dist to infinity
*    min_dist = np.inf
    
    *# Iterate over the database to calulate distance for each person*
    **for** (name, emb) **in** db.items():
        
        *# Compute the distance*
        curr_dist = np.linalg.norm(input_embedding - emb)

*        # identity is set to the name of the person from the database whose distance is smallest against the input encoding
*        **if** curr_dist &lt; min_dist:
            min_dist = curr_dist
            identity = name
    
    **if** min_dist &gt; 0.7:
        print("Sorry! You‚Äôre not in the database.")
    **else**:
        print ("Hi! Welcome " + identity) &gt; # Congratulations!! üëèüëè You have created your own Face Recognition system.
</code></pre></div></div>

<h2 id="if-you-have-learned-something-then-feel-free-to-press-for-as-long-as-you-want">
<a class="anchor" href="#if-you-have-learned-something-then-feel-free-to-press-for-as-long-as-you-want" aria-hidden="true"><span class="octicon octicon-link"></span></a>If you have learned something then feel free to pressüëè for as long as you wantüòÉ.</h2>

<h2 id="if-you-find-anything-wrong-please-mention-it-in-the-comments-i-would-Ô∏è-to-improve">
<a class="anchor" href="#if-you-find-anything-wrong-please-mention-it-in-the-comments-i-would-%EF%B8%8F-to-improve" aria-hidden="true"><span class="octicon octicon-link"></span></a>If you find anything wrong, please mention it in the comments. I would ‚ù§Ô∏è to improve.</h2>

<p><strong>You can contact me at <a href="http://twitter.com/iamaniketmaurya">twitter.com/aniketmaurya</a> or drop your üìß at <a href="http://aniketmaurya@outlook.com">aniketmaurya@outlook.com</a></strong></p>

  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="aniketmaurya/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/tensorflow/face%20recognition/2019/01/07/face-recognition.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Blogs on AI and Programming.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/aniketmaurya" title="aniketmaurya"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/aniketmaurya" title="aniketmaurya"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
